@inject Models.MyFile myFile;
@inject Models.MockInstructionList mockInstructionList;
@inject Services.MenuService menuService;
@inject Services.Analysis Analyzer;
@inject Services.HardwareService HWS;
@inject Services.DebugService debugService;

<InputFile OnChange="@LoadFiles"/>

@if (!string.IsNullOrEmpty(myFile.Name))
{
    <p>@myFile.Name</p>
}

@code {



    private async void LoadFiles(InputFileChangeEventArgs e)
    {
        myFile.Name = e.File.Name;
        //myFile.MyStreamReader = await new StreamReader(e.File.OpenReadStream()).ReadToEndAsync();
        StreamReader sr = new StreamReader(e.File.OpenReadStream());
        string? line;
        while ((line = await sr.ReadLineAsync()) != null)
        {
            myFile.Lines.Add(new Models.MyLine(line));
        }
        myFile.RemoveEmptyLines();
        menuService.NotifyChanged();
        HWS.Initialize();
        Analyzer.Analyze(myFile);
        mockInstructionList.CreateMockInstructionList();
        debugService.InitializeDebug(mockInstructionList._instructions);

    }
}
